# Модуль 12. Вступ до LINQ

## Що таке LINQ?

**LINQ (Language Integrated Query)** - це потужна технологія в .NET, яка дозволяє виконувати запити до різних джерел даних безпосередньо в коді C#. LINQ інтегрований безпосередньо в мову програмування, що робить роботу з даними простішою та зрозумілішою.

### Основні переваги LINQ:
- **Уніфікований синтаксис** - однаковий підхід до роботи з різними джерелами даних
- **Типобезпека** - компілятор перевіряє правильність запитів на етапі компіляції
- **Читабельність коду** - запити виглядають природно та зрозуміло
- **IntelliSense підтримка** - автодоповнення в IDE для зручної роботи

## Цілі та завдання LINQ

### Основні цілі:
1. **Спрощення роботи з даними** - замість складних циклів та умов можна використовувати декларативні запити
2. **Уніфікація підходів** - однаковий синтаксис для роботи з масивами, списками, базами даних, XML тощо
3. **Підвищення продуктивності розробки** - менше коду, більше функціональності
4. **Покращення читабельності** - код стає більш зрозумілим та підтримуваним

### Завдання LINQ:
- Фільтрація даних за певними умовами
- Сортування колекцій
- Групування елементів
- Проекція (вибірка) потрібних полів
- Агрегація (підрахунок, сума, середнє значення)
- Об'єднання різних джерел даних
- Перетворення даних

## Поняття запиту

### Запит у LINQ

**Запит (Query)** - це набір інструкцій, які описують, які дані потрібно отримати та як їх обробити. LINQ підтримує два синтаксиси написання запитів:

1. **Query Syntax (синтаксис запитів)** - схожий на SQL
2. **Method Syntax (синтаксис методів)** - використання методів розширення

### Синтаксис запиту

#### Query Syntax (синтаксис запитів)
```csharp
var result = from item in collection
             where item.Condition
             select item;
```

#### Method Syntax (синтаксис методів)
```csharp
var result = collection.Where(item => item.Condition);
```

Обидва підходи еквівалентні, але синтаксис методів більш гнучкий та часто використовується в реальних проєктах.

### Виконання запиту

Важливо розуміти різницю між **відкладеним (deferred)** та **негайним (immediate)** виконанням:

- **Відкладене виконання** - запит виконується тільки коли до нього звертаються (foreach, ToList(), ToArray() тощо)
- **Негайне виконання** - запит виконується одразу (Count(), First(), Sum() тощо)

### Сортування

LINQ надає потужні можливості для сортування даних:

- **OrderBy** - сортування за зростанням
- **OrderByDescending** - сортування за спаданням
- **ThenBy** - додаткове сортування (для багаторівневого сортування)
- **ThenByDescending** - додаткове сортування за спаданням

### Групування

**GroupBy** дозволяє групувати елементи колекції за певною ознакою:

```csharp
var groups = collection.GroupBy(item => item.Category);
```

Результат - колекція груп, де кожна група містить ключ та елементи, що належать до цієї групи.

### Інші операції

LINQ надає багато корисних операцій:

- **Where** - фільтрація
- **Select** - проекція (перетворення)
- **SelectMany** - "розгортання" колекцій
- **Take** - взяти перші N елементів
- **Skip** - пропустити перші N елементів
- **First/FirstOrDefault** - перший елемент
- **Last/LastOrDefault** - останній елемент
- **Any** - перевірка наявності елементів
- **All** - перевірка, чи всі елементи відповідають умові
- **Count** - кількість елементів
- **Sum/Average/Min/Max** - математичні операції
- **Distinct** - унікальні елементи
- **Concat** - об'єднання колекцій
- **Join** - з'єднання колекцій

## Використання LINQ і колекцій

LINQ працює з будь-якими колекціями, що реалізують інтерфейс `IEnumerable<T>`:

- Масиви (Array)
- Списки (List<T>)
- Словники (Dictionary<TKey, TValue>)
- Множини (HashSet<T>)
- Черги (Queue<T>)
- Стеки (Stack<T>)
- Власні колекції, що реалізують IEnumerable<T>

### Приклад роботи з різними колекціями:

```csharp
// Масив
int[] numbers = { 1, 2, 3, 4, 5 };
var evenNumbers = numbers.Where(n => n % 2 == 0);

// Список
List<string> names = new List<string> { "Ivan", "Petro", "Maria" };
var longNames = names.Where(n => n.Length > 4);

// Словник
Dictionary<int, string> dict = new Dictionary<int, string>();
var values = dict.Values.Where(v => v.StartsWith("A"));
```

## Приклади використання

У файлі `Program.cs` ви знайдете детальні практичні приклади, які демонструють:

1. **Базові операції** - фільтрація, проекція, сортування
2. **Робота з колекціями об'єктів** - запити до списків студентів, продуктів
3. **Групування** - групування за різними критеріями
4. **Агрегація** - підрахунки, суми, середні значення
5. **Комбіновані запити** - складніші приклади з кількома операціями

### Як працювати з матеріалами:

1. **Прочитайте** пояснення в цьому README
2. **Відкрийте** файл `Program.cs`
3. **Запустіть** програму та подивіться результати
4. **Модифікуйте** приклади - змінюйте умови, додавайте свої дані
5. **Створюйте** власні запити на основі наданих прикладів

### Практичні завдання для самостійної роботи:

1. Створіть список з 10 студентів з різними оцінками та знайдіть всіх, хто має оцінку вище 80
2. Згрупуйте студентів за курсом та знайдіть середню оцінку для кожного курсу
3. Створіть список продуктів та знайдіть найдорожчий продукт у кожній категорії
4. Використайте Join для об'єднання списку студентів та їх оцінок
5. Створіть запит, який повертає топ-3 студентів за середньою оцінкою

**Пам'ятайте**: найкращий спосіб навчитися LINQ - це практика! Експериментуйте з кодом, змінюйте запити та спостерігайте за результатами.

