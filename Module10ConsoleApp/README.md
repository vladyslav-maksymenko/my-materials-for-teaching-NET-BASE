# –ú–æ–¥—É–ª—å 10. –ó–±–∏—Ä–∞–Ω–Ω—è —Å–º—ñ—Ç—Ç—è (Garbage Collection) –≤ .NET

## –ó–º—ñ—Å—Ç
1. [–ñ–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª –æ–±'—î–∫—Ç—ñ–≤](#–∂–∏—Ç—Ç—î–≤–∏–π-—Ü–∏–∫–ª-–æ–±—î–∫—Ç—ñ–≤)
2. [–ü–æ–Ω—è—Ç—Ç—è —Å–∫–ª–∞–¥–∞–ª—å–Ω–∏–∫–∞ —Å–º—ñ—Ç—Ç—è](#–ø–æ–Ω—è—Ç—Ç—è-—Å–∫–ª–∞–¥–∞–ª—å–Ω–∏–∫–∞-—Å–º—ñ—Ç—Ç—è)
3. [–î–µ—Å—Ç—Ä—É–∫—Ü—ñ—è —ñ –º–µ—Ç–æ–¥ Finalize](#–¥–µ—Å—Ç—Ä—É–∫—Ü—ñ—è-—ñ-–º–µ—Ç–æ–¥-finalize)
4. [–ú–µ—Ç–æ–¥ Dispose —Ç–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å IDisposable](#–º–µ—Ç–æ–¥-dispose-—Ç–∞-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å-idisposable)
5. [–ö–ª–∞—Å System.GC](#–∫–ª–∞—Å-systemgc)
6. [–ü–æ–Ω—è—Ç—Ç—è –ø–æ–∫–æ–ª—ñ–Ω—å –ø—Ä–∏ –∑–±–∏—Ä–∞–Ω–Ω—ñ —Å–º—ñ—Ç—Ç—è](#–ø–æ–Ω—è—Ç—Ç—è-–ø–æ–∫–æ–ª—ñ–Ω—å-–ø—Ä–∏-–∑–±–∏—Ä–∞–Ω–Ω—ñ-—Å–º—ñ—Ç—Ç—è)
7. [–ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏](#–ø—Ä–∞–∫—Ç–∏—á–Ω—ñ-–ø—Ä–∏–∫–ª–∞–¥–∏)

---

## –ñ–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª –æ–±'—î–∫—Ç—ñ–≤
–ü—Ä–∞–∫—Ç–∏—á–Ω–æ –±—É–¥—å-—è–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–∞ –¥–ª—è —Å–≤–æ—î—ó —Ä–æ–±–æ—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ä—ñ–∑–Ω—ñ –æ–±'—î–∫—Ç–∏, —Ä–æ–±–æ—Ç–∞ –∑ —è–∫–∏–º–∏ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –≤–∏—Ç—Ä–∞—á–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ—ó –ø–∞–º'—è—Ç—ñ. –ü—Ä–∏ –æ–±'—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–æ–º—É –ø—ñ–¥—Ö–æ–¥—ñ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –∫–æ–∂–µ–Ω —Ç–∏–ø –æ–ø–∏—Å—É—î —è–∫–∏–π—Å—å –æ–±'—î–∫—Ç, –∑ —è–∫–∏–º –ø—ñ—Å–ª—è –π–æ–≥–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–∂–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–∞.

–£ .NET –æ–±'—î–∫—Ç–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç—å —á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—É–ø–Ω—ñ –æ—Å–Ω–æ–≤–Ω—ñ –µ—Ç–∞–ø–∏ –∂–∏—Ç—Ç—î–≤–æ–≥–æ —Ü–∏–∫–ª—É:

![–°—Ö–µ–º–∞ —Ä–æ–±–æ—Ç–∏ Generics](PhotoForReadme\lifecycle.jpg)

| –ï—Ç–∞–ø | –ù–∞–∑–≤–∞ | –û–ø–∏—Å –ø—Ä–æ—Ü–µ—Å—É |
| :--- | :--- | :--- |
| **1** | **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è (Allocation)** | –û–±'—î–∫—Ç —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –≤ –∫–µ—Ä–æ–≤–∞–Ω—ñ–π –∫—É–ø—ñ (**managed heap**) –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ `new`. |
| **2** | **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è (Usage)** | –û–±'—î–∫—Ç –∞–∫—Ç–∏–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –ø—Ä–æ–≥—Ä–∞–º—ñ (–Ω–∞ –Ω—å–æ–≥–æ —î –ø–æ—Å–∏–ª–∞–Ω–Ω—è). |
| **3** | **–í—Ç—Ä–∞—Ç–∞ –ø–æ—Å–∏–ª–∞–Ω—å (Unreachable)** | –û–±'—î–∫—Ç —Å—Ç–∞—î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–º, –∫–æ–ª–∏ –Ω–∞ –Ω—å–æ–≥–æ –±—ñ–ª—å—à–µ –Ω–µ –≤–∫–∞–∑—É—î –∂–æ–¥–Ω–∞ –∞–∫—Ç–∏–≤–Ω–∞ –∑–º—ñ–Ω–Ω–∞. |
| **4** | **–ó–±—ñ—Ä–∫–∞ —Å–º—ñ—Ç—Ç—è (Garbage Collection)** | **GC** –∞–Ω–∞–ª—ñ–∑—É—î –ø–∞–º'—è—Ç—å —ñ –≤–∏–∑–Ω–∞—á–∞—î, —â–æ –æ–±'—î–∫—Ç –º–æ–∂–Ω–∞ –≤–∏–¥–∞–ª–∏—Ç–∏. |
| **5** | **–§—ñ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è (Finalization)** | –Ø–∫—â–æ —É –∫–ª–∞—Å—É —î –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä (Finalizer), –≤—ñ–Ω –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø–µ—Ä–µ–¥ –ø–æ–≤–Ω–∏–º –≤–∏–¥–∞–ª–µ–Ω–Ω—è–º. |
| **6** | **–í–∏–¥–∞–ª–µ–Ω–Ω—è (Deallocation)** | –ü–∞–º'—è—Ç—å –∑–≤—ñ–ª—å–Ω—è—î—Ç—å—Å—è, —ñ –º—ñ—Å—Ü–µ —Å—Ç–∞—î –¥–æ—Å—Ç—É–ø–Ω–∏–º –¥–ª—è –Ω–æ–≤–∏—Ö –æ–±'—î–∫—Ç—ñ–≤. |

---

## –ü–æ–Ω—è—Ç—Ç—è –∑–±–∏—Ä–∞—á–∞ —Å–º—ñ—Ç—Ç—è —Ç–∞ –π–æ–≥–æ –ø–æ–∫–æ–ª—ñ–Ω—å

**Garbage Collector (GC)** - —Ü–µ –Ω–µ –ø—Ä–æ—Å—Ç–æ ¬´–ø—Ä–∏–±–∏—Ä–∞–ª—å–Ω–∏–∫¬ª –∞–±–æ ¬´–º–µ–Ω–µ–¥–∂–µ—Ä¬ª, —Ü–µ —Å–∫–ª–∞–¥–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç—É –ø–∞–º'—è—Ç—ñ, –≥–æ–ª–æ–≤–Ω–∞ –º–µ—Ç–∞ —è–∫–æ—ó ‚Äî –∑–∞–ø–æ–±—ñ–≥—Ç–∏ Memory Leaks —Ç–∞ –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –¥–∞–Ω–∏—Ö.
### –î–µ –∂–∏–≤—É—Ç—å –æ–±'—î–∫—Ç–∏? (Stack vs Heap)
–ü–µ—Ä—à –∑–∞ –≤—Å–µ, GC –ø—Ä–∞—Ü—é—î —Ç—ñ–ª—å–∫–∏ –∑ Managed Heap (–∫–µ—Ä–æ–≤–∞–Ω–æ—é –∫—É–ø–æ—é).
- Stack (–°—Ç–µ–∫): –®–≤–∏–¥–∫–∞ –ø–∞–º'—è—Ç—å –¥–ª—è –∑–Ω–∞—á—É—â–∏—Ö —Ç–∏–ø—ñ–≤ (int, bool, struct) —Ç–∞ –ø–æ—Å–∏–ª–∞–Ω—å. –û—á–∏—â–∞—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏ –≤–∏—Ö–æ–¥—ñ –∑ –º–µ—Ç–æ–¥—É.
- Managed Heap (–ö—É–ø–∞): –¢—É—Ç –∂–∏–≤—É—Ç—å —É—Å—ñ –ø–æ—Å–∏–ª–∞–ª—å–Ω—ñ —Ç–∏–ø–∏ (class, string, –º–∞—Å–∏–≤–∏). –°–∞–º–µ —Ç—É—Ç GC –ø—Ä–æ–≤–æ–¥–∏—Ç—å —Å–≤–æ—ó ¬´—Ä–µ–π–¥–∏¬ª.

–û—Å–∫—ñ–ª—å–∫–∏ –ø–∞–º'—è—Ç—å, —â–æ –≤–∏–¥—ñ–ª—è—î—Ç—å—Å—è, –Ω–µ –±–µ–∑–º–µ–∂–Ω–∞, —Ç–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –ø–µ—Ä—ñ–æ–¥–∏—á–Ω–æ –∑–≤—ñ–ª—å–Ω—è—Ç–∏ –ø–∞–º'—è—Ç—å, –≤–∏–¥—ñ–ª–µ–Ω—É –ø—ñ–¥ –æ–±'—î–∫—Ç–∏, —è–∫—ñ –±—ñ–ª—å—à–µ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ –¥–æ–¥–∞—Ç–∫—É (–Ω–∞ –Ω–∏—Ö –Ω–µ–º–∞—î –¥—ñ–π—Å–Ω–∏—Ö –ø–æ—Å–∏–ª–∞–Ω—å). –¶—é —Ä–æ–±–æ—Ç—É –≤–∏–∫–æ–Ω—É—î –∑–±–∏—Ä–∞—á —Å–º—ñ—Ç—Ç—è, —è–∫–∏–π —î –Ω–µ–¥–µ—Ä–º—ñ–Ω–æ–≤–∞–Ω–∏–º –ø—Ä–æ—Ü–µ—Å–æ–º, —Ç–æ–±—Ç–æ –Ω–µ–º–æ–∂–ª–∏–≤–æ –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, –∫–æ–ª–∏ CLR ¬´–≤–∏—Ä—ñ—à–∏—Ç—å¬ª –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –ø—Ä–æ—Ü–µ—Å –∑–±–∏—Ä–∞–Ω–Ω—è —Å–º—ñ—Ç—Ç—è —É –í–∞—à–æ–º—É –¥–æ–¥–∞—Ç–∫—É. –û–¥–Ω–∞–∫, –í–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–∏–º—É—Å–æ–≤–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∑–±–∏—Ä–∞–Ω–Ω—è —Å–º—ñ—Ç—Ç—è, –≤–∏–∫–ª–∏–∫–∞–≤—à–∏ –≤ –¥–æ–¥–∞—Ç–∫—É –º–µ—Ç–æ–¥ `Collect()` –∫–ª–∞—Å—É `System.GC`.

### –°—Ç—Ä–∞—Ç–µ–≥—ñ—è —Ç—Ä—å–æ—Ö –ø–æ–∫–æ–ª—ñ–Ω—å (Generations)
–î–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó GC –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≥—ñ–ø–æ—Ç–µ–∑—É: "–ß–∏–º –¥–æ–≤—à–µ –æ–±'—î–∫—Ç –∂–∏–≤–µ, —Ç–∏–º –±—ñ–ª—å—à–∞ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å, —â–æ –≤—ñ–Ω –∂–∏—Ç–∏–º–µ —â–µ –¥–æ–≤—à–µ". –¢–æ–º—É –∫—É–ø–∞ —Ä–æ–∑–¥—ñ–ª–µ–Ω–∞ –Ω–∞ —Ç—Ä–∏ –∑–æ–Ω–∏:
| –ü–æ–∫–æ–ª—ñ–Ω–Ω—è | –ù–∞–∑–≤–∞ (–º–µ—Ç–∞—Ñ–æ—Ä–∞) | –û–ø–∏—Å | –ß–∞—Å—Ç–æ—Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ |
| :--- | :--- | :--- | :--- |
| **Gen 0** | üë∂ "–î–∏—Ç—è—á–∏–π —Å–∞–¥–æ–∫" | –°—é–¥–∏ –ø–æ—Ç—Ä–∞–ø–ª—è—é—Ç—å —É—Å—ñ –Ω–æ–≤—ñ –æ–±'—î–∫—Ç–∏ (–∫—Ä—ñ–º –¥—É–∂–µ –≤–µ–ª–∏–∫–∏—Ö). –¶–µ –Ω–∞–π–º–µ–Ω—à–∞ –∑–æ–Ω–∞ –∑–∞ —Ä–æ–∑–º—ñ—Ä–æ–º. | **–î—É–∂–µ —á–∞—Å—Ç–æ** (–∫–æ–∂–Ω—ñ –∫—ñ–ª—å–∫–∞ –º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥). |
| **Gen 1** | üë¶ "–ü—ñ–¥–ª—ñ—Ç–∫–∏" | –û–±'—î–∫—Ç–∏, —è–∫—ñ –ø–µ—Ä–µ–∂–∏–ª–∏ –æ–¥–Ω—É –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –≤ Gen 0. –°–ª—É–∂–∏—Ç—å –±—É—Ñ–µ—Ä–æ–º –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –¥–æ "–¥–æ—Ä–æ—Å–ª–æ–≥–æ" –∂–∏—Ç—Ç—è. | **–°–µ—Ä–µ–¥–Ω—è.** |
| **Gen 2** | üë¥ "–°—Ç–∞—Ä–æ–∂–∏–ª–∏" | –û–±'—î–∫—Ç–∏, —â–æ –ø–µ—Ä–µ–∂–∏–ª–∏ –±–∞–≥–∞—Ç–æ –∑–±–∏—Ä–∞–Ω—å, –∞–±–æ –¥—É–∂–µ –≤–µ–ª–∏–∫—ñ –æ–±'—î–∫—Ç–∏. –ù–∞–π–±—ñ–ª—å—à–∞ –∑–æ–Ω–∞ –∑–∞ –æ–±—Å—è–≥–æ–º. | **–†—ñ–¥–∫–æ.** –¶–µ –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è "–ø–æ–≤–Ω–∏–º –∑–±–∏—Ä–∞–Ω–Ω—è–º" (Full GC). |

–Ü—Å–Ω—É—î —â–µ **LOH (Large Object Heap)** ‚Äî —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∞ –∑–æ–Ω–∞ –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –æ–±'—î–∫—Ç—ñ–≤ (–≤—ñ–¥ 85 –ö–ë). –í–æ–Ω–∏ –æ–¥—Ä–∞–∑—É –ø–æ—Ç—Ä–∞–ø–ª—è—é—Ç—å —É Gen 2, –±–æ —ó—Ö –¥—É–∂–µ –¥–æ—Ä–æ–≥–æ –ø–µ—Ä–µ—Å—É–≤–∞—Ç–∏ –≤ –ø–∞–º'—è—Ç—ñ.

### –Ø–∫ –ø—Ä–∞—Ü—é—î –∞–ª–≥–æ—Ä–∏—Ç–º "Mark & Compact" (–ü–æ–∑–Ω–∞—á —Ç–∞ –°—Ç—è–≥–Ω–∏)
–ö–æ–ª–∏ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è —Ü–∏–∫–ª –∑–±–∏—Ä–∞–Ω–Ω—è, GC –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —Ç—Ä–∏ —Ñ–∞–∑–∏:

- –§–∞–∑–∞ –º–∞—Ä–∫—É–≤–∞–Ω–Ω—è (Mark): GC –±–µ—Ä–µ ¬´–∫–æ—Ä–µ–Ω—ñ¬ª (roots) ‚Äî —Ü–µ —Å—Ç–∞—Ç–∏—á–Ω—ñ –∑–º—ñ–Ω–Ω—ñ, –ª–æ–∫–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ –≤ –ø–æ—Ç–æ—á–Ω–∏—Ö –º–µ—Ç–æ–¥–∞—Ö, —Ä–µ–≥—ñ—Å—Ç—Ä–∏ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞. –í—ñ–Ω —ñ–¥–µ –ø–æ –ª–∞–Ω—Ü—é–∂–∫–∞—Ö –ø–æ—Å–∏–ª–∞–Ω—å —ñ –ø–æ–∑–Ω–∞—á–∞—î –≤—Å—ñ –æ–±'—î–∫—Ç–∏, –¥–æ —è–∫–∏—Ö –∑–º—ñ–≥ "–¥–æ—Ç—è–≥–Ω—É—Ç–∏—Å—è", —è–∫ –ñ–∏–≤—ñ.

- –§–∞–∑–∞ –æ—á–∏—â–µ–Ω–Ω—è (Sweep): –£—Å—ñ –æ–±'—î–∫—Ç–∏, —â–æ –Ω–µ –º–∞—é—Ç—å –º—ñ—Ç–∫–∏ ¬´–∂–∏–≤–∏–π¬ª, –≤–≤–∞–∂–∞—é—Ç—å—Å—è —Å–º—ñ—Ç—Ç—è–º.

- –§–∞–∑–∞ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è (Compact): –¶–µ ¬´–º–∞–≥—ñ—è¬ª .NET. –©–æ–± —É –ø–∞–º'—è—Ç—ñ –Ω–µ –±—É–ª–æ ¬´–¥—ñ—Ä–æ–∫¬ª (—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü—ñ—ó), GC –ø–µ—Ä–µ—Å—É–≤–∞—î –∂–∏–≤—ñ –æ–±'—î–∫—Ç–∏ –≤–ø—Ä–∏—Ç—É–ª –æ–¥–∏–Ω –¥–æ –æ–¥–Ω–æ–≥–æ.

–¶–µ —è–∫ –¥–µ—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü—ñ—è –¥–∏—Å–∫–∞: —Ç–µ–ø–µ—Ä –Ω–æ–≤—ñ –æ–±'—î–∫—Ç–∏ –º–æ–∂–Ω–∞ –≤–∏–¥—ñ–ª—è—Ç–∏ —à–≤–∏–¥—à–µ –≤ –æ–¥–Ω–æ–º—É –≤–µ–ª–∏–∫–æ–º—É –≤—ñ–ª—å–Ω–æ–º—É –±–ª–æ—Ü—ñ.

### –†–æ–ª—å –ì—Ä–∞—Ñ–∞ –æ–±'—î–∫—Ç—ñ–≤
–ì—Ä–∞—Ñ –æ–±'—î–∫—Ç—ñ–≤ ‚Äî —Ü–µ ¬´–∫–∞—Ä—Ç–∞ –∑–≤'—è–∑–∫—ñ–≤¬ª. CLR –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –π–æ–≥–æ, —â–æ–± –Ω–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –æ–±'—î–∫—Ç, —è–∫–∏–π –≤–∞–º —â–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω.

–¶–∏–∫–ª—ñ—á–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è: –Ø–∫—â–æ –û–±'—î–∫—Ç –ê –ø–æ—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ –ë, –∞ –ë –Ω–∞ –ê, –∞–ª–µ –Ω—ñ—Ö—Ç–æ —ñ–Ω—à–∏–π —É –ø—Ä–æ–≥—Ä–∞–º—ñ –Ω–∞ –Ω–∏—Ö –Ω–µ –ø–æ—Å–∏–ª–∞—î—Ç—å—Å—è ‚Äî GC —Ç–∞–∫–∏–π —Ä–æ–∑—É–º–Ω–∏–π, —â–æ –≤–∏–¥–∞–ª–∏—Ç—å –æ–±–æ—Ö. –°—Ç–∞—Ä—ñ —Å–∏—Å—Ç–µ–º–∏ (—è–∫ COM) –Ω–∞ —Ç–∞–∫–æ–º—É ¬´–∑–∞–≤–∏—Å–∞–ª–∏¬ª, –∞ .NET ‚Äî –Ω—ñ.

### –ö–æ–ª–∏ GC –≤–∏—Ö–æ–¥–∏—Ç—å –Ω–∞ —Ä–æ–±–æ—Ç—É?
‚ö†Ô∏è **–ù–µ–º–æ–∂–ª–∏–≤–æ –ø–µ—Ä–µ–¥–±–∞—á–∏—Ç–∏ —Ç–æ—á–Ω–∏–π –º–æ–º–µ–Ω—Ç –≤–∏–¥–∞–ª–µ–Ω–Ω—è**
GC ‚Äî —Ü–µ —Ñ–æ–Ω–æ–≤–∏–π –ø–æ—Ç—ñ–∫ –∑ –Ω–∏–∑—å–∫–∏–º –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–æ–º, –∞–ª–µ –≤—ñ–Ω –∞–∫—Ç–∏–≤—É—î—Ç—å—Å—è –º–∏—Ç—Ç—î–≤–æ, —è–∫—â–æ:
- –°–∏—Å—Ç–µ–º—ñ –±—Ä–∞–∫—É—î —Ñ—ñ–∑–∏—á–Ω–æ—ó –ø–∞–º'—è—Ç—ñ.
- –û–±'—î–º–∏ –≤ Gen 0 –∞–±–æ Gen 1 –ø–µ—Ä–µ–≤–∏—â–∏–ª–∏ –ø–µ–≤–Ω–∏–π –ª—ñ–º—ñ—Ç.
- –í–∏ –≤–∏–∫–ª–∏–∫–∞–ª–∏ GC.Collect() (–Ω–µ —Ä–æ–±—ñ—Ç—å —Ü—å–æ–≥–æ –±–µ–∑ –∫—Ä–∞–π–Ω—å–æ—ó –ø–æ—Ç—Ä–µ–±–∏!).

### –ü–µ—Ä–µ–≤–∞–≥–∏ GC:
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø–∞–º'—è—Ç—Ç—é** - –Ω–µ–º–∞—î –≤–∏—Ç–æ–∫—ñ–≤ –ø–∞–º'—è—Ç—ñ (memory leaks)

‚úÖ **–ë–µ–∑–ø–µ–∫–∞** - –Ω–µ–º–æ–∂–ª–∏–≤–æ –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –≤–∏–¥–∞–ª–µ–Ω–æ—ó –ø–∞–º'—è—Ç—ñ

‚úÖ **–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è** - GC –æ–ø—Ç–∏–º—ñ–∑—É—î —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è –æ–±'—î–∫—Ç—ñ–≤

---

## –î–µ—Å—Ç—Ä—É–∫—Ü—ñ—è —ñ –º–µ—Ç–æ–¥ Finalize

**–î–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä** (finalizer) - —Ü–µ –º–µ—Ç–æ–¥, —è–∫–∏–π –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è GC –ø–µ—Ä–µ–¥ –≤–∏–¥–∞–ª–µ–Ω–Ω—è–º –æ–±'—î–∫—Ç–∞.

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å:
```csharp
class MyClass
{
    ~MyClass()
    {
        // –ö–æ–¥ –æ—á–∏—â–µ–Ω–Ω—è
    }
}
```

### –í–∞–∂–ª–∏–≤–æ –∑–Ω–∞—Ç–∏:
- –î–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä **–Ω–µ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –º–∏—Ç—Ç—î–≤–æ** –ø—ñ—Å–ª—è –≤—Ç—Ä–∞—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω—å
- –û–±'—î–∫—Ç –∑ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–º –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ **–¥–≤–∞ –µ—Ç–∞–ø–∏ –∑–±–∏—Ä–∞–Ω–Ω—è —Å–º—ñ—Ç—Ç—è**:
  1. –ü–µ—Ä—à–∏–π –µ—Ç–∞–ø: –æ–±'—î–∫—Ç –ø–µ—Ä–µ–º—ñ—â—É—î—Ç—å—Å—è –≤ —á–µ—Ä–≥—É —Ñ—ñ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—ó
  2. –î—Ä—É–≥–∏–π –µ—Ç–∞–ø: –ø—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ –æ–±'—î–∫—Ç –≤–∏–¥–∞–ª—è—î—Ç—å—Å—è
- –û–±'—î–∫—Ç–∏ –∑ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞–º–∏ **–∂–∏–≤—É—Ç—å –¥–æ–≤—à–µ** (–≥–µ–Ω–µ—Ä–∞—Ü—ñ—è 2)
- **–ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–∏ –¥–ª—è –∑–≤–∏—á–∞–π–Ω–∏—Ö –æ–±'—î–∫—Ç—ñ–≤
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–∏ **—Ç—ñ–ª—å–∫–∏ –¥–ª—è –∑–≤—ñ–ª—å–Ω–µ–Ω–Ω—è –Ω–µ—É–ø—Ä–∞–≤–ª—è–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤**

### –ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
- –†–æ–±–æ—Ç–∞ –∑ –Ω–µ–∫–µ—Ä–æ–≤–∞–Ω–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ (—Ñ–∞–π–ª–∏, –º–µ—Ä–µ–∂–µ–≤—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è, –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∏ –û–°)
- –Ø–∫ —Ä–µ–∑–µ—Ä–≤–Ω–∏–π –º–µ—Ö–∞–Ω—ñ–∑–º –æ—á–∏—â–µ–Ω–Ω—è (—è–∫—â–æ –∑–∞–±—É–ª–∏ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ Dispose)

---

## –ú–µ—Ç–æ–¥ Dispose —Ç–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å IDisposable
**IDisposable** - —Ü–µ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î —è–≤–Ω–æ –∑–≤—ñ–ª—å–Ω—è—Ç–∏ —Ä–µ—Å—É—Ä—Å–∏.

### –ü–∞—Ç—Ç–µ—Ä–Ω Dispose:

```csharp
public class MyResource : IDisposable
{
    private bool _disposed = false;

    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this); // –ù–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä
        //–ó–∞–ø–æ–±—ñ–≥–∞—î –ø–æ–¥–≤—ñ–π–Ω–æ–º—É –æ—á–∏—â–µ–Ω–Ω—é —Ç–∞ –ø—Ä–∏—Å–∫–æ—Ä—é—î –≤–∏–¥–∞–ª–µ–Ω–Ω—è –æ–±'—î–∫—Ç–∞ –∑ –ø–∞–º'—è—Ç—ñ.
    }

    protected virtual void Dispose(bool disposing)
    {
        if (!_disposed)
        {
            if (disposing)
            {
                // –ó–≤—ñ–ª—å–Ω–∏—Ç–∏ —É–ø—Ä–∞–≤–ª—è–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏
            }
            // –ó–≤—ñ–ª—å–Ω–∏—Ç–∏ –Ω–µ—É–ø—Ä–∞–≤–ª—è–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏
            _disposed = true;
        }
    }

    ~MyResource()
    {
        Dispose(false); // –†–µ–∑–µ—Ä–≤–Ω–µ –æ—á–∏—â–µ–Ω–Ω—è
    }
}
```

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:
```csharp
// –Ø–≤–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
using (var resource = new MyResource())
{
    // –†–æ–±–æ—Ç–∞ –∑ —Ä–µ—Å—É—Ä—Å–æ–º
} // Dispose –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ

// –ê–±–æ
var resource = new MyResource();
try
{
    // –†–æ–±–æ—Ç–∞ –∑ —Ä–µ—Å—É—Ä—Å–æ–º
}
finally
{
    resource?.Dispose();
}
```

### using statement (C# 8.0+):
```csharp
using var resource = new MyResource();
// –†–æ–±–æ—Ç–∞ –∑ —Ä–µ—Å—É—Ä—Å–æ–º
// Dispose –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –≤ –∫—ñ–Ω—Ü—ñ –æ–±–ª–∞—Å—Ç—ñ –≤–∏–¥–∏–º–æ—Å—Ç—ñ
```

### –ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ IDisposable:
- –†–æ–±–æ—Ç–∞ –∑ —Ñ–∞–π–ª–∞–º–∏ (FileStream, StreamReader)
- –†–æ–±–æ—Ç–∞ –∑ –±–∞–∑–∞–º–∏ –¥–∞–Ω–∏—Ö (SqlConnection)
- –†–æ–±–æ—Ç–∞ –∑ –º–µ—Ä–µ–∂–µ—é (HttpClient, TcpClient)
- –†–æ–±–æ—Ç–∞ –∑ –≥—Ä–∞—Ñ—ñ–∫–æ—é (Graphics, Bitmap)
- –ë—É–¥—å-—è–∫—ñ –Ω–µ—É–ø—Ä–∞–≤–ª—è–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏
---

## –ö–ª–∞—Å System.GC

**System.GC** - —Å—Ç–∞—Ç–∏—á–Ω–∏–π –∫–ª–∞—Å –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ Garbage Collector.
–ó–¥–µ–±—ñ–ª—å—à–æ–≥–æ —Ü–µ–π –∫–ª–∞—Å –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏ –ø—ñ–¥ —á–∞—Å —Ä–æ–±–æ—Ç–∏ –∑ –Ω–µ–∫–µ—Ä–æ–≤–∞–Ω–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏. –ü—Ä–∏–º—É—Å–æ–≤–æ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –∑–±–∏—Ä–∞—á–∞ —Å–º—ñ—Ç—Ç—è –ø—ñ–¥ —á–∞—Å —Ä–æ–±–æ—Ç–∏ –∑ –∫–µ—Ä–æ–≤–∞–Ω–∏–º –∫–æ–¥–æ–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –ª–∏—à–µ –≤ –∫—Ä–∞–π–Ω—ñ—Ö –≤–∏–ø–∞–¥–∫–∞—Ö.

–ü–µ—Ä—à–∏–π –∑ —Ç–∞–∫–∏—Ö –≤–∏–ø–∞–¥–∫—ñ–≤ –º–æ–∂–µ —Å—Ç–∞—Ç–∏—Å—è, –∫–æ–ª–∏ –í–∞—à –¥–æ–¥–∞—Ç–æ–∫ –ø–æ—á–∏–Ω–∞—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —è–∫–æ–≥–æ—Å—å –∫–æ–¥—É —ñ –π–æ–≥–æ –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –Ω–µ–ø–æ–ø—Ä–∞–≤–Ω–∏—Ö –Ω–∞—Å–ª—ñ–¥–∫—ñ–≤. –ó–±–∏—Ä–∞–Ω–Ω—è —Å–º—ñ—Ç—Ç—è –º–æ–∂–µ —Å—Ç–∞—Ç–∏ –æ–¥–Ω—ñ—î—é –∑ –ø—Ä–∏—á–∏–Ω —Ç–∞–∫–æ–≥–æ –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è, —Ç–æ–º—É —â–æ, –Ω–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ —Ç–µ, —â–æ —Ä–æ–±–æ—Ç–∞ –∑–±–∏—Ä–∞—á–∞ —Å–º—ñ—Ç—Ç—è –¥–æ—Å–∏—Ç—å –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∞, –ø—ñ–¥ —á–∞—Å –¥–µ—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü—ñ—ó –ø–∞–º'—è—Ç—ñ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –ø—Ä–∏–∑—É–ø–∏–Ω–µ–Ω–Ω—è –ø–æ—Ç–æ–∫—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–∞, —Ö–æ—á–∞ –π –Ω–∞ –Ω–µ—Ç—Ä–∏–≤–∞–ª–∏–π —á–∞—Å.

–î—Ä—É–≥–∞ —Å–∏—Ç—É–∞—Ü—ñ—è –º–æ–∂–µ –≤–∏–Ω–∏–∫–Ω—É—Ç–∏, –∫–æ–ª–∏ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–¥—ñ–ª–∏—Ç–∏ –≤–µ–ª–∏–∫–∏–π –æ–±—Å—è–≥ –ø–∞–º'—è—Ç—ñ –ø—ñ–¥ –ø–µ–≤–Ω—ñ –æ–±'—î–∫—Ç–∏ —ñ –π–æ–≥–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –∑–≤—ñ–ª—å–Ω–∏—Ç–∏ —è–∫–æ–º–æ–≥–∞ —à–≤–∏–¥—à–µ.

–ü—Ä–∏–º—É—Å–æ–≤–∏–π –∑–∞–ø—É—Å–∫ –∑–±–∏—Ä–∞—á–∞ —Å–º—ñ—Ç—Ç—è –∑–¥—ñ–π—Å–Ω—é—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤–∏–∫–ª–∏–∫—É –º–µ—Ç–æ–¥—É Collect() –∫–ª–∞—Å—É System.GC. –£ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ–º—É –≤–∞—Ä—ñ–∞–Ω—Ç—ñ —Ü–µ–π –º–µ—Ç–æ–¥ –ø—Ä–∏–π–º–∞—î –Ω–æ–º–µ—Ä –ø–æ–∫–æ–ª—ñ–Ω–Ω—è, –≤ —è–∫–æ–º—É –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –∑–±—ñ—Ä–∫—É —Å–º—ñ—Ç—Ç—è.
### –û—Å–Ω–æ–≤–Ω—ñ –º–µ—Ç–æ–¥–∏:

#### GC.Collect()
```csharp
GC.Collect(); // –ó–±—ñ—Ä–∫–∞ –≤—Å—ñ—Ö –ø–æ–∫–æ–ª—ñ–Ω—å
GC.Collect(0); // –ó–±—ñ—Ä–∫–∞ —Ç—ñ–ª—å–∫–∏ –ø–æ–∫–æ–ª—ñ–Ω–Ω—è 0
GC.Collect(2, GCCollectionMode.Forced); // –ü—Ä–∏–º—É—Å–æ–≤–∞ –∑–±—ñ—Ä–∫–∞
```

#### GC.WaitForPendingFinalizers()
```csharp
GC.Collect();
GC.WaitForPendingFinalizers(); // –ß–µ–∫–∞—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ñ—ñ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—ó
GC.Collect(); // –ü–æ–≤—Ç–æ—Ä–Ω–∞ –∑–±—ñ—Ä–∫–∞
```

#### GC.GetGeneration()
```csharp
var obj = new MyClass();
int generation = GC.GetGeneration(obj); // –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ–∫–æ–ª—ñ–Ω–Ω—è –æ–±'—î–∫—Ç–∞
```

#### GC.GetTotalMemory()
```csharp
long memory = GC.GetTotalMemory(false); // –ü–æ—Ç–æ—á–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –ø–∞–º'—è—Ç—å
```

#### GC.SuppressFinalize()
```csharp
GC.SuppressFinalize(this); // –°–∫–∞—Å—É–≤–∞—Ç–∏ –≤–∏–∫–ª–∏–∫ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞
```

### –í–∞–∂–ª–∏–≤–æ:
‚ö†Ô∏è **–ù–µ –≤–∏–∫–ª–∏–∫–∞–π—Ç–µ GC.Collect() –≤ –ø—Ä–æ–¥–∞–∫—à–Ω –∫–æ–¥—ñ –±–µ–∑ –ø–æ—Ç—Ä–µ–±–∏!**
- GC –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–π –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—ó —Ä–æ–±–æ—Ç–∏
- –ü—Ä–∏–º—É—Å–æ–≤–∞ –∑–±—ñ—Ä–∫–∞ –º–æ–∂–µ –ø–æ–≥—ñ—Ä—à–∏—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ç—ñ–ª—å–∫–∏ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∞–±–æ –≤ –æ—Å–æ–±–ª–∏–≤–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö

---

## –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏

### –ü—Ä–∏–∫–ª–∞–¥ 1: –ñ–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª –æ–±'—î–∫—Ç–∞

```csharp
// –û–±'—î–∫—Ç —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –≤ Gen 0
var obj = new MyClass();

// –û–±'—î–∫—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è
obj.DoSomething();

// –í—Ç—Ä–∞—Ç–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è - –æ–±'—î–∫—Ç —Å—Ç–∞—î –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–º –Ω–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è
obj = null;

// GC –º–æ–∂–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –æ–±'—î–∫—Ç –ø—Ä–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π –∑–±—ñ—Ä—Ü—ñ
```

### –ü—Ä–∏–∫–ª–∞–¥ 2: –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –ø–æ–∫–æ–ª—ñ–Ω—å

```csharp
var obj = new MyClass();
Console.WriteLine($"–ü—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è: Gen {GC.GetGeneration(obj)}");

GC.Collect(0);
Console.WriteLine($"–ü—ñ—Å–ª—è –∑–±—ñ—Ä–∫–∏ Gen 0: Gen {GC.GetGeneration(obj)}");

GC.Collect(1);
Console.WriteLine($"–ü—ñ—Å–ª—è –∑–±—ñ—Ä–∫–∏ Gen 1: Gen {GC.GetGeneration(obj)}");
```

### –ü—Ä–∏–∫–ª–∞–¥ 3: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è IDisposable

```csharp
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∫–ª–∏–∫–∞–Ω–Ω—è Dispose
using (var resource = new FileResource("test.txt"))
{
    resource.WriteData("Hello, World!");
} // Dispose –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è —Ç—É—Ç

// –°—É—á–∞—Å–Ω–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å (C# 8.0+)
using var resource2 = new FileResource("test2.txt");
resource2.WriteData("Data");
// Dispose –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –≤ –∫—ñ–Ω—Ü—ñ –æ–±–ª–∞—Å—Ç—ñ –≤–∏–¥–∏–º–æ—Å—Ç—ñ
```

### –ü—Ä–∏–∫–ª–∞–¥ 4: –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –ø–∞–º'—è—Ç—ñ

```csharp
long memoryBefore = GC.GetTotalMemory(false);
Console.WriteLine($"–ü–∞–º'—è—Ç—å –¥–æ: {memoryBefore / 1024} KB");

// –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–±'—î–∫—Ç—ñ–≤
for (int i = 0; i < 1000; i++)
{
    var obj = new MyClass();
}

long memoryAfter = GC.GetTotalMemory(false);
Console.WriteLine($"–ü–∞–º'—è—Ç—å –ø—ñ—Å–ª—è: {memoryAfter / 1024} KB");
Console.WriteLine($"–†—ñ–∑–Ω–∏—Ü—è: {(memoryAfter - memoryBefore) / 1024} KB");
```

### –ü—Ä–∏–∫–ª–∞–¥ 5: –î–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä vs Dispose

```csharp
// –û–±'—î–∫—Ç –∑ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–º
var objWithFinalizer = new ClassWithFinalizer();
objWithFinalizer = null;
GC.Collect();
GC.WaitForPendingFinalizers(); // –ß–µ–∫–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞

// –û–±'—î–∫—Ç –∑ Dispose
using (var objWithDispose = new ClassWithDispose())
{
    // –†–æ–±–æ—Ç–∞ –∑ –æ–±'—î–∫—Ç–æ–º
} // Dispose –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –º–∏—Ç—Ç—î–≤–æ
```

### –ü—Ä–∏–∫–ª–∞–¥ 6: IAsyncDisposable (—Å—É—á–∞—Å–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥)

```csharp
// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–µ –æ—á–∏—â–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤
await using var asyncResource = new AsyncResource("file.txt");
await asyncResource.WriteDataAsync("Data");
// DisposeAsync –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤ –∫—ñ–Ω—Ü—ñ –æ–±–ª–∞—Å—Ç—ñ –≤–∏–¥–∏–º–æ—Å—Ç—ñ

// –ê–±–æ –∑ —è–≤–Ω–∏–º –±–ª–æ–∫–æ–º
await using (var resource = new AsyncResource("file2.txt"))
{
    await resource.WriteDataAsync("Data");
} // DisposeAsync –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è —Ç—É—Ç
```

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —Ç–∞ –Ω–∞–π–∫—Ä–∞—â—ñ –ø—Ä–∞–∫—Ç–∏–∫–∏

### ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è:
1. **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ IDisposable** –¥–ª—è —Ä–µ—Å—É—Ä—Å—ñ–≤, —â–æ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –æ—á–∏—â–µ–Ω–Ω—è
2. **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ using** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –≤–∏–∫–ª–∏–∫–∞–Ω–Ω—è Dispose
3. **–†–µ–∞–ª—ñ–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω Dispose** –¥–ª—è –∫–ª–∞—Å—ñ–≤ –∑ –Ω–µ—É–ø—Ä–∞–≤–ª—è–Ω–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏
4. **–î–æ–∑–≤–æ–ª—å—Ç–µ GC –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ** - –Ω–µ –≤–∏–∫–ª–∏–∫–∞–π—Ç–µ GC.Collect() –±–µ–∑ –ø–æ—Ç—Ä–µ–±–∏

### ‚ùå –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è:
1. **–ù–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–∏** –¥–ª—è –∑–≤–∏—á–∞–π–Ω–∏—Ö –æ–±'—î–∫—Ç—ñ–≤
2. **–ù–µ –≤–∏–∫–ª–∏–∫–∞–π—Ç–µ GC.Collect()** –≤ –ø—Ä–æ–¥–∞–∫—à–Ω –∫–æ–¥—ñ
3. **–ù–µ —Ç—Ä–∏–º–∞–π—Ç–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è** –Ω–∞ –æ–±'—î–∫—Ç–∏, —è–∫—ñ –±—ñ–ª—å—à–µ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω—ñ
4. **–ù–µ —Å—Ç–≤–æ—Ä—é–π—Ç–µ –∑–∞–π–≤—ñ –æ–±'—î–∫—Ç–∏** –≤ —Ü–∏–∫–ª–∞—Ö (–æ—Å–æ–±–ª–∏–≤–æ –≤–µ–ª–∏–∫—ñ)

### üîç –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º –∑ –ø–∞–º'—è—Ç—Ç—é:
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **dotMemory**, **PerfView**, –∞–±–æ **Visual Studio Diagnostic Tools**
- –ú–æ–Ω—ñ—Ç–æ—Ä—Ç–µ **GC.GetTotalMemory()** –¥–ª—è –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ
- –ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ **GC.GetGeneration()** –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è –∂–∏—Ç—Ç—î–≤–æ–≥–æ —Ü–∏–∫–ª—É –æ–±'—î–∫—Ç—ñ–≤

---

## –í–∏—Å–Ω–æ–≤–∫–∏

1. **GC –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∫–µ—Ä—É—î –ø–∞–º'—è—Ç—Ç—é** - –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ —è–≤–Ω–æ –∑–≤—ñ–ª—å–Ω—è—Ç–∏ –æ–±'—î–∫—Ç–∏
2. **IDisposable –¥–ª—è —Ä–µ—Å—É—Ä—Å—ñ–≤** - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –¥–ª—è —Ñ–∞–π–ª—ñ–≤, –∑'—î–¥–Ω–∞–Ω—å —Ç–æ—â–æ
3. **–ü–æ–∫–æ–ª—ñ–Ω–Ω—è –æ–ø—Ç–∏–º—ñ–∑—É—é—Ç—å GC** - –±—ñ–ª—å—à—ñ—Å—Ç—å –æ–±'—î–∫—Ç—ñ–≤ –ø–æ–º–∏—Ä–∞—é—Ç—å –≤ Gen 0
4. **–î–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–∏ - —Ä—ñ–¥–∫—ñ—Å—Ç—å** - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ç—ñ–ª—å–∫–∏ –¥–ª—è –Ω–µ—É–ø—Ä–∞–≤–ª—è–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤
5. **–î–æ–≤—ñ—Ä—Ç–µ—Å—è GC** - –≤—ñ–Ω –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–π –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—ó —Ä–æ–±–æ—Ç–∏

---

## –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏

- [Microsoft Docs: Garbage Collection](https://learn.microsoft.com/en-us/dotnet/standard/garbage-collection/)
- [Microsoft Docs: IDisposable Pattern](https://learn.microsoft.com/en-us/dotnet/standard/garbage-collection/implementing-dispose)
- [.NET Memory Management](https://learn.microsoft.com/en-us/dotnet/standard/garbage-collection/fundamentals)